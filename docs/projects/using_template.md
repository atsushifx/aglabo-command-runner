# Using This Template

Guide for creating a new project from this template.

## Initial Setup

### 1. Create Repository from Template

**On GitHub**:

1. Navigate to this repository
2. Click "Use this template" button
3. Choose "Create a new repository"
4. Fill in repository details
5. Click "Create repository from template"

**Or fork**:

```bash
# Fork on GitHub, then clone
git clone <your-repo-url>
cd <your-repo>
```

### 2. Clone and Install

```bash
# Clone your new repository
git clone <your-repo-url>
cd <your-repo>

# Install dependencies
pnpm install

# Install Git hooks
pnpm prepare
```

### 3. Install Development Tools (Windows)

```powershell
# Install all development tools
.\scripts\install-dev-tools.ps1

# Install documentation tools
.\scripts\install-doc-tools.ps1
```

**Installs**:

- lefthook, delta, gitleaks, dprint (via Scoop)
- dotenvx (via WinGet)
- commitlint, secretlint, cspell (via pnpm)
- textlint, markdownlint (via pnpm)

## Customization

### 1. Update package.json

Edit `package.json`:

```json
{
  "name": "@your-scope/your-package-name",
  "description": "Your package description",
  "version": "0.1.0",
  "author": "Your Name <your.email@example.com>",
  "keywords": [
    "your",
    "keywords"
  ]
}
```

**Add build and test scripts**:

```json
{
  "scripts": {
    "build": "tsup --config ./configs/tsup.config.esm.ts",
    "build:watch": "tsup --config ./configs/tsup.config.esm.ts --watch",
    "test": "vitest run",
    "test:unit": "vitest --config ./configs/vitest.config.unit.ts",
    "test:functional": "vitest --config ./configs/vitest.config.functional.ts",
    "test:watch": "vitest watch"
  }
}
```

### 2. Update LICENSE

Replace placeholder with your information:

```text
MIT License

Copyright (c) 2025 <Your Name>
Permission is hereby granted...
```

### 3. Update README

Edit `README.md` and `README.ja.md`:

- Change project name and description
- Update installation instructions
- Add usage examples
- Update badges and links

### 4. Update CONTRIBUTING

Edit `CONTRIBUTING.md` and `CONTRIBUTING.ja.md`:

- Replace `atsushifx/aglabo-command-runner` with your repo
- Update issue tracker links
- Customize contribution guidelines

## Create Source Code Structure

### 1. Create Directories

```bash
mkdir src
mkdir src/core
mkdir src/utils
mkdir src/__tests__
mkdir src/__tests__/unit
mkdir src/__tests__/functional
```

### 2. Create Entry Point

Create `src/index.ts`:

```typescript
// src: ./src/index.ts
// @(#) : Main entry point
//
// Copyright (c) 2025 Your Name <your.email@example.com>
//
// This software is released under the MIT License.
// https://opensource.org/licenses/MIT

export { YourMainClass } from './core/your-main-class.js';
export type { YourType } from './types.js';
```

### 3. Create Implementation Files

Create your core functionality in `src/core/`:

```typescript
// src/core/your-main-class.ts
export class YourMainClass {
  // Your implementation
}
```

### 4. Create Tests

Create tests in `src/__tests__/unit/`:

```typescript
// src/__tests__/unit/your-main-class.spec.ts
import { describe, expect, it } from 'vitest';
import { YourMainClass } from '../../core/your-main-class.js';

describe('YourMainClass', () => {
  it('should work', () => {
    const instance = new YourMainClass();
    expect(instance).toBeDefined();
  });
});
```

## Development Workflow

### 1. Write Code

Edit files in `src/`:

- Follow TypeScript strict mode
- Use ES2022 syntax
- Follow 2-space indentation
- Use LF line endings

### 2. Run Quality Checks

Before committing:

```bash
# Format code
pnpm format:dprint

# Type check
pnpm check:types

# Lint
pnpm lint:filenames
pnpm lint:text
pnpm lint:markdown

# Spell check
pnpm check:spells

# Security scan (CRITICAL)
pnpm lint:secrets
```

### 3. Run Tests

```bash
# Unit tests
pnpm test:unit

# All tests
pnpm test

# Watch mode
pnpm test:watch
```

### 4. Build

```bash
# Clean previous build
pnpm clean

# Build
pnpm build

# Build in watch mode
pnpm build:watch
```

### 5. Commit Changes

```bash
# Stage changes
git add .

# Commit (message auto-generated)
git commit

# Push
git push
```

The commit message is automatically generated by `scripts/prepare-commit-msg.sh`.

## Publishing

### 1. Update Version

```bash
# Bump version
pnpm version patch  # or minor, major
```

### 2. Build for Production

```bash
# Clean and build
pnpm clean
pnpm build
```

### 3. Publish to npm

```bash
# Dry run
pnpm publish --dry-run

# Publish
pnpm publish --access public
```

## Configuration Customization

### TypeScript

Edit `tsconfig.json` to adjust:

- Compiler options
- Include/exclude patterns
- Path aliases

### ESLint

Edit `configs/eslint.config.js` or `configs/eslint.config.typed.js`:

- Add custom rules
- Adjust severity levels

### Vitest

Edit `configs/vitest.config.*.ts`:

- Adjust test patterns
- Configure coverage
- Add test setup files

### dprint

Edit `dprint.jsonc`:

- Adjust line width
- Configure formatting rules

## MCP Server Integration

### Update Memories

After creating implementation:

1. **Update project_overview** (serena-mcp):

   ```typescript
   mcp__plugin_claude - idd - framework_serena - mcp__write_memory({
     memory_file_name: 'project_overview',
     content: 'Updated project description...',
   });
   ```

2. **Update lsmcp_index_info** (lsmcp):

   ```typescript
   mcp__lsmcp__write_memory({
     root: 'C:\\path\\to\\your-repo',
     memoryName: 'lsmcp_index_info',
     content: 'Updated index info...',
   });
   ```

## Common Tasks

### Adding New Dependencies

```bash
# Add runtime dependency
pnpm add <package>

# Add dev dependency
pnpm add -D <package>
```

### Adding New Scripts

Edit `package.json`:

```json
{
  "scripts": {
    "your-script": "your-command"
  }
}
```

### Adding New Configuration

1. Create config file in `configs/`
2. Reference from tool or `package.json`
3. Document in `docs/`

### Adding New Documentation

1. Create `.md` file in `docs/`
2. Reference from `CLAUDE.md` or `README.md`

## Troubleshooting

### Git Hooks Not Running

```bash
# Reinstall hooks
pnpm prepare
```

### Type Check Fails

```bash
# Check tsconfig.json includes src/
# Ensure all files have proper imports
# Fix TypeScript errors
```

### Build Fails

```bash
# Check tsup.config.esm.ts
# Ensure src/index.ts exports everything
# Verify no circular dependencies
```

### Tests Fail

```bash
# Check test file patterns
# Ensure vitest.config.*.ts includes test files
# Fix failing tests
```

## Next Steps

After setup:

1. **Write implementation** in `src/`
2. **Write tests** in `src/__tests__/`
3. **Update documentation** in `README.md` and `docs/`
4. **Configure CI/CD** in `.github/workflows/`
5. **Publish** to npm

## Template Maintenance

### Pulling Template Updates

If the original template is updated:

```bash
# Add original template as remote
git remote add template <template-repo-url>

# Fetch updates
git fetch template

# Merge updates (resolve conflicts)
git merge template/main
```

### Keeping in Sync

Periodically check for template updates:

- Tool configurations
- Security scanning rules
- Git hook improvements
- Documentation enhancements

## Support

- Template issues can be reported to the original template repository
- Project-specific issues should use your repository's issue tracker
- For Claude Code usage, refer to CLAUDE.md and docs/
- MCP server integration details are in docs/mcp_servers.md
